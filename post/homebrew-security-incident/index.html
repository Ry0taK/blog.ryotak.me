<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=HandheldFriendly content="True"><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=generator content="Hugo 0.80.0"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>HomebrewのCaskリポジトリを介した任意コード実行 - RyotaK's Blog</title><meta name=author content="RyotaK"><meta name=description content="技術的な話とか"><meta name=keywords content="Homebrew,脆弱性,Ruby,Supply Chain"><meta property="og:title" content="HomebrewのCaskリポジトリを介した任意コード実行"><meta name=twitter:title content="HomebrewのCaskリポジトリを介した任意コード実行"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.ryotak.me/post/homebrew-security-incident/"><meta property="og:description" content="English version is available here: https://blog.ryotak.me/post/homebrew-security-incident-en/ (公式インシデント報告はこちらから読むことができます: https://brew.sh/2021/04/21/security-incident-disclosure/) はじめに HomebrewプロジェクトはHackerOne上で脆弱性開示制度(Vulnerability Disclosure Program)を設けており"><meta name=twitter:description content="English version is available here: https://blog.ryotak.me/post/homebrew-security-incident-en/ (公式インシデント報告はこちらから読むことができます: https://brew.sh/2021/04/21/security-incident-disclosure/) はじめに HomebrewプロジェクトはHackerOne上で脆弱性開示制度(Vulnerability Disclosure Program)を設けており"><meta name=twitter:card content="summary"><meta property="article:published_time" content="2021-04-21T19:00:00+09:00"><meta property="article:modified_time" content="2021-04-21T19:00:00+09:00"><link rel=stylesheet href=https://blog.ryotak.me/assets/css/fuji.min.css></head><body data-theme=dark data-theme-auto=false><script data-cfasync=false>var fujiThemeData=localStorage.getItem('fuji_data-theme');if(!fujiThemeData){localStorage.setItem('fuji_data-theme','auto');}else{if(fujiThemeData!=='auto'){document.body.setAttribute('data-theme',fujiThemeData==='dark'?'dark':'light');}}</script><header><div class="container-lg clearfix"><div class="col-12 header"><a class=title-main href=https://blog.ryotak.me>RyotaK's Blog</a>
<span class=title-sub>技術的な話とか</span></div></div></header><main><div class="container-lg clearfix"><div class="col-12 col-md-9 float-left content"><article><h2 class="post-item post-title"><a href=https://blog.ryotak.me/post/homebrew-security-incident/>HomebrewのCaskリポジトリを介した任意コード実行</a></h2><div class="post-item post-meta"><span><i class="iconfont icon-today-sharp"></i>&nbsp;2021-04-21</span>
<span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;6143 字</span>
<span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href=/tags/homebrew>Homebrew</a>&nbsp;<a href=/tags/%E8%84%86%E5%BC%B1%E6%80%A7>脆弱性</a>&nbsp;<a href=/tags/ruby>Ruby</a>&nbsp;<a href=/tags/supply-chain>Supply Chain</a>&nbsp;</span></div><div class="post-content markdown-body"><p>English version is available here: <a href=https://blog.ryotak.me/post/homebrew-security-incident-en/>https://blog.ryotak.me/post/homebrew-security-incident-en/</a><br>(公式インシデント報告はこちらから読むことができます: <a href=https://brew.sh/2021/04/21/security-incident-disclosure/>https://brew.sh/2021/04/21/security-incident-disclosure/</a>)</p><h2 id=はじめに>はじめに</h2><p>HomebrewプロジェクトはHackerOne上で脆弱性開示制度(Vulnerability Disclosure Program)を設けており、脆弱性の診断行為が許可されています。<br>本記事は、当該制度に参加し、Homebrewプロジェクトのスタッフから許可を得た上で実施した脆弱性診断行為について解説したものであり、無許可の脆弱性診断行為を推奨することを意図したものではありません。<br>Homebrewに脆弱性を発見した場合は、<a href=https://hackerone.com/homebrew target=_blank>Homebrewプロジェクトの脆弱性開示制度</a>へ報告してください。</p><h2 id=要約>要約</h2><p>HomebrewのCaskを管理しているリポジトリにおいて、プルリクエストの自動レビュー機能に使用されているライブラリにバグが存在し、結果として自動レビュー機能に悪意のないプルリクエストだと誤判定させることが可能だった。<br>これにより、悪意のあるコードを<a href=https://github.com/Homebrew/homebrew-cask target=_blank>Homebrew/homebrew-cask</a>へ自動的にマージし、Homebrewを利用しているユーザーのコンピューター上で任意のRubyコードを実行することができた。</p><h2 id=調査理由>調査理由</h2><p>とある日の午後、次の予定までの時間が微妙に空いていた<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>ため、HackerOne上で面白そうなプログラムを探すことにした。<br>自分が利用しているサービス/ソフトウェアの脆弱性を優先して探したいと思ったため、手元のPCの中を漁っていると、<code>brew</code>コマンドに目が行った。<br>以前、HackerOne上のプログラム一覧を眺めているときに、Homebrewというプログラムを見かけたことを思い出し、せっかくなので脆弱性を探すことにした。</p><p><img class=img-zoomable src=/img/homebrew-hackerone-program.png alt=HackerOne上のHomebrewプログラムの画像></p><h2 id=調査対象の選定>調査対象の選定</h2><p>調査する対象を選定するために、脆弱性開示制度のポリシーページを確認すると、<code>brew</code>コマンド本体の他に<code>Homebrew/homebrew-*</code>にマッチするGitHubリポジトリに関する脆弱性報告を受け付けていることに気がついた。<br>複雑なRubyのコードを読むのが苦手なので、ひとまず<code>Homebrew/homebrew-*</code>における脆弱性を探すことにした。</p><p><img class=img-zoomable src=/img/homebrew-hackerone-scope.png alt=HackerOne上のHomebrewプログラムにおけるスコープセクション></p><h2 id=初期調査>初期調査</h2><p>GitHubリポジトリにおける脆弱性は、主に以下の2つが多いように思われる。</p><ol><li>当該のリポジトリに対する書き込み権限を持ったトークンの漏洩</li><li>当該のリポジトリが利用しているCIスクリプトにおける脆弱性</li></ol><p>そのため、これら2つの脆弱性に絞り、脆弱性を確認していくことにした。<br>1つ目に関して確認するために、<a href=https://github.com/Homebrew target=_blank>Homebrew</a>に所属しているユーザーが所有しているリポジトリをすべて取得し、それらの中からトークンと思わしき文字列を抽出していった。<br>しかしながら、この方法での脆弱性が見つかるのは非常に稀であり、当然有効なトークンは見つからなかった。<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><p>そのため、2つ目に関連した脆弱性が無いかどうか確認することにした。</p><h2 id=ciスクリプトの調査>CIスクリプトの調査</h2><p>Homebrewは、CIスクリプトを実行するために<a href=https://github.com/features/actions target=_blank>GitHub Actions</a>を使用している。<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup><br>そのため、各リポジトリの<code>.github/workflows/</code>配下のファイルを調べていくことにした。</p><p>いくつかのリポジトリを確認した後、<code>Homebrew/homebrew-cask</code>に置かれていた<a href=https://github.com/Homebrew/homebrew-cask/blob/aa89774e95530994ae95a9e6aad7eca1bde41033/.github/workflows/review.yml target=_blank><code>review.yml</code></a>と、<a href=https://github.com/Homebrew/homebrew-cask/blob/4986c6b25133c8e536a4f39136c8dafe20ff2a38/.github/workflows/automerge.yml target=_blank><code>automerge.yml</code></a>に非常に強い関心を持った。<br>どうやら、<code>review.yml</code>がユーザーが送信したプルリクエストの内容を確認し、そのプルリクエストが非常に単純な変更(例: バージョンアップなど)のみを加える場合、自動でプルリクエストを承認し、その後<code>automerge.yml</code>が承認されたプルリクエストを自動でマージしているようだった。</p><p><img class=img-zoomable src=/img/homebrew-review-workflow.png alt=review.ymlの抜粋画像>
<img class=img-zoomable src=/img/homebrew-automerge-workflow.png alt=automerge.ymlの抜粋画像></p><h2 id=reviewymlの調査>review.ymlの調査</h2><p><code>review.yml</code>が利用しているRubyスクリプト<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>は変更点をdiffファイルとして取得し、それを<a href=https://github.com/anolson/git_diff target=_blank><code>git_diff</code></a>というGemを用いてパースする。<br>その後、以下の条件を満たしている場合にのみプルリクエストを承認していた。</p><ol><li>変更中のファイルが1つのみ</li><li>ファイルを移動/新規作成/削除していない</li><li>変更中のファイルパスが<code>\ACasks/[^/]+\.rb\Z</code>にマッチする</li><li>削除した行数と追加した行数が同数</li><li>削除/追加した行の全てが<code>/\A[+-]\s*version "([^"]+)"\Z/</code>か<code>\A[+-]\s*sha256 "[0-9a-f]{64}"\Z</code>のどちらかにマッチする</li><li>バージョンが変更される場合、フォーマットが以前と同様 (例: <code>1.2.3</code> => <code>2.3.4</code>)</li></ol><p>&mldr;等<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup></p><p>条件を精査したが、非常に厳密な条件だったため脆弱性は見つからず、この条件下で任意のコードを挿入するのは不可能であると結論付けた。<br>その後、しばらく他のスクリプトの確認を行っていたのだが、どういうわけかこのスクリプトの事が頭から離れなかった。<br>そのため、このスクリプトを徹底的に調べることにし、diffファイルのパースを行っているライブラリを調べ始めた。</p><h2 id=git_diffの調査>git_diffの調査</h2><p><a href=https://github.com/anolson/git_diff target=_blank><code>git_diff</code></a>のリポジトリを眺めている際に、<a href=https://github.com/anolson/git_diff/issues/12 target=_blank>変更された行数のパースが間違っているという旨のIssue</a>を発見した。<br>このIssueを見て、どうにかして<code>git_diff</code>を混乱させ、上記の条件を満たすように偽装できないかと考え始めた。</p><p>詳しくコードを読んでいくと、どうやら<code>git_diff</code>は以下のような処理を行いdiffファイルをパースしているようだった。</p><ol><li>ファイルの内容を改行区切りで分割する</li><li>それぞれの行に対して、<code>^diff --git(?: a/(\S+))?(?: b/(\S+))?</code>がマッチするかどうかを確認し、マッチすればファイル情報として判定し、現在処理中のファイル情報を正規表現にマッチしたものに置き換える。</li><li>2でマッチしなければ、以下の正規表現にマッチするかを確認、マッチしていれば変更元/変更先のファイルパスを内容に応じて書き換える。
<img class=img-zoomable src=/img/homebrew-path-regex.png alt=diffファイルの移動元/移動先ファイルパスにマッチする正規表現></li><li>3でマッチしなければ、ファイル自体の変更として扱い、<code>+</code>で始まっていれば追加、<code>-</code>で始まっていれば削除、それ以外は元々のファイル内容として扱う。</li><li>上記を繰り返し、全ての行を処理し次第終了する。</li></ol><p>一見問題ないように見えるこの処理だが、3の移動元/移動先ファイルパスにマッチするかどうかの判定を複数回走らせることが可能となっていた。</p><p>GitHubが返すdiffファイルは、以下の構造の変更データをファイルごとに作成し、それを単一ファイルに纏めたものとなっている。</p><pre><code class=language-diff>diff --git a/変更前のファイルパス b/変更後のファイルパス
index 親コミットハッシュ..現コミットハッシュ ファイルモード
--- a/変更前のファイルパス
+++ b/変更後のファイルパス
@@ 行情報 @@
以下変更詳細 (例: `+asdf`、`-zxcv`等)
</code></pre><p>行追加に関しては、追加された行の前に<code>+</code>を追加することにより表現される。</p><p>つまり、<code>++ "?b/(.*)</code>にマッチする行であれば、ファイル内容の変更ではなく変更中のファイルパス情報として認識されてしまう状態だった。<br>ここで、先程の条件を確認すると、変更中のファイルパスに対する条件は<code>\ACasks/[^/]+\.rb\Z</code>だけとなっている。<br>先述の通りファイルパス情報変更は複数回行えるため、以下のような変更を加えることにより上記の条件を回避し、変更された行が0行の無害なプルリクエストと判定させることができる可能性が高かった。<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup></p><pre><code class=language-ruby>++ &quot;b/#{ここに任意のコード}&quot;
++ b/Casks/cask.rb
</code></pre><h2 id=デモンストレーションの準備>デモンストレーションの準備</h2><p>HackerOne等のバグバウンティプラットフォームは、基本的にPoCや脆弱性のデモンストレーションをレポート内で送信する必要がある。<br>そのため、この脆弱性が実際に悪用可能かどうかを確かめることにした。　</p><p>実際に使用されているCaskを許可なく変更するのはあまりよろしくないため、<code>homebrew-cask</code>内において、テスト用のCaskを探すことにした。<br>しかしながら、テスト用のCaskが見つからなかったため、仕方なくHomebrewの脆弱性開示制度を担当している方にメールを送信した。</p><p>その後、担当している方から<code>これだけのためにテスト用のCaskを追加する無理なので、代わりに既存のCaskに無害な変更を加えてくれ</code>という旨の返信が帰ってきた。<br>そのため、適当なCaskを選び、無害な変更を加えることにした。</p><h2 id=脆弱性のデモンストレーション>脆弱性のデモンストレーション</h2><p>この日の前日に<a href=https://github.com/Homebrew/homebrew-cask/pull/104167 target=_blank>GitHubのAPI Tokenをうっかり載せてしまったプルリクエスト</a>を見かけていたため、このプルリクエストが変更しようとしていた<code>iterm2.rb</code>に対して変更を加えることにした。</p><p>変更を加える際に気がついたのだが、<code>++ "b/"</code>はRubyの文法として間違っていないが、<code>++ b/Casks/iterm2.rb</code>は変数を定義しないとエラーになってしまう。<br>そのため、<code>Homebrew/homebrew-cask</code>をフォークし、以下の2行を<code>Casks/iterm2.rb</code>へ追記した。<sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup></p><pre><code class=language-ruby>++ &quot;b/#{puts 'Going to report it - RyotaK (https://hackeorne.com/ryotak)';b = 1;Casks = 1;iterm2 = {};iterm2.define_singleton_method(:rb) do 1 end}&quot;
++ b/Casks/iterm2.rb
</code></pre><p>一行目で<code>b</code>、<code>Casks</code>、<code>iterm2</code>、<code>iterm2.rb</code>を定義することにより、二行目でエラーが発生しなくなるため、有効なRubyスクリプトとして実行することができるようになる。<br>そして、この変更を加えることにより、GitHubは以下のようなDiffを返す。</p><pre><code class=language-diff>diff --git a/Casks/iterm2.rb b/Casks/iterm2.rb
index 3c376126bb1cf9..ba6f4299c1824e 100644
--- a/Casks/iterm2.rb
+++ b/Casks/iterm2.rb
@@ -8,6 +8,8 @@
     sha256 &quot;e7403dcc5b08956a1483b5defea3b75fb81c3de4345da6000e3ad4a6188b47df&quot;
   end
 
+++ &quot;b/#{puts 'Going to report it - RyotaK (https://hackeorne.com/ryotak)';b = 1;Casks = 1;iterm2 = {};iterm2.define_singleton_method(:rb) do 1 end}&quot;
+++ b/Casks/iterm2.rb
   url &quot;https://iterm2.com/downloads/stable/iTerm2-#{version.dots_to_underscores}.zip&quot;
   name &quot;iTerm2&quot;
   desc &quot;Terminal emulator as alternative to Apple's Terminal app&quot;
</code></pre><p>前述の通り、<code>git_diff</code>は<code>+++ "?b/(.*)</code>にマッチする変更を行追加ではなく変更中のファイル情報として扱うため、このDiffは<code>Casks/iterm2.rb</code>に対して0行の変更を加えるものとして扱われてしまう。</p><p>この変更を加えた上でプルリクエストを作成<sup id=fnref:8><a href=#fn:8 class=footnote-ref role=doc-noteref>8</a></sup>し、脆弱性のデモンストレーションを開始した。</p><h2 id=問題発生>問題発生</h2><p>その後、しばらく待ってもプルリクエストがマージされず、なぜかと思いCIの実行ログを確認すると、<code>Required status checks for pull request 104191 are not successful.</code>というログが出力されていた。<br>失敗しているチェックを洗い出した所、<code>brew style</code>を実行してコードの構文チェックを行っており、この部分で実行される<a href=https://github.com/rubocop/rubocop target=_blank>Rubocop</a>がコードが汚いと怒っていることがわかった。</p><p><img class=img-zoomable src=/img/homebrew-rubocop-fail.png alt="GitHub Actions上でRubocopが失敗している画像"></p><p>Rubocopは<code># rubocop:disable all</code>というコメントを行末尾に追加することにより、特定の行に対しての警告を無効化することができる。<br>一行目に関してはこれを追記するだけで済んだのだが、二行目は<code>+++ "?b/(.*)</code>のグルーピングされている部分にマッチする文字列が<code>Casks/iterm2.rb</code>である必要があったため、このコメントを追加することによる解決はできなかった。　　</p><p>いくつかの試行錯誤の後、以下のような変更を加えることにより最後の行を変更せずにRubocopを黙らせることが可能であることがわかった。</p><pre><code class=language-ruby>++ &quot;b/#{puts 'Going to report it - RyotaK (https://hackerone.com/ryotak)';b = 1;Casks = 1;iterm2 = {};iterm2.define_singleton_method(:rb) do 1 end; }&quot; # rubocop:disable all
++ &quot;b/&quot; if # rubocop:disable all
++ b/Casks/iterm2.rb
</code></pre><p>二行目で<code>if</code>を追加し、次の行を<code>if</code>式として評価させることにより<code>Operator / used in void context.</code>という警告が出ないように調整している。</p><p>これにより、プルリクエストに対して実行されているチェックが全て成功するようになり、無事に<code>BrewTestBot</code>によってプルリクエストがマージされた。<br><img class=img-zoomable src=/img/homebrew-merge-success.png alt=BrewTestBotが自動的にマージした際の画像></p><h2 id=問題発生再び>問題発生、再び</h2><p>無事にプルリクエストがマージされたため、<code>brew install iterm2 --cask</code>を実行し、<code>Going to report it - RyotaK (https://hackerone.com/ryotak)</code>が出力されることを確認し、PoCとして画像を送信した。</p><p><img class=img-zoomable src=/img/homebrew-install-poc.png alt="brew install iterm2 &amp;ndash;caskが変更後のコードを参照している事を示す画像"></p><p>その後、送信したレポートに対する返信を待っている間に、以下のようなリプライがTwitter上で送られてきた。<br><blockquote class=twitter-tweet><p lang=en dir=ltr><a href="https://twitter.com/ryotkak?ref_src=twsrc%5Etfw">@ryotkak</a> - do you take credit for my <a href="https://twitter.com/hashtag/homebrew?src=hash&ref_src=twsrc%5Etfw">#homebrew</a> behaviour? :) <a href=https://t.co/CczRDTemu9>pic.twitter.com/CczRDTemu9</a></p>&mdash; mrkosmici (@mrkosmici) <a href="https://twitter.com/mrkosmici/status/1383730296609144847?ref_src=twsrc%5Etfw">April 18, 2021</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script>一瞬理解できなかったのだが、よく見ると<code>brew cleanup</code>を実行した際にも<code>Going to report it - RyotaK (https://hackerone.com/ryotak)</code>が表示されてしまっているようだった。<br>慌てて手元で試すと、確かに<code>brew cleanup</code>実行時にも<code>Going to report it - RyotaK (https://hackerone.com/ryotak)</code>が表示されてしまっていた。</p><p>この時は非常に慌てていたため気が付かなかったのだが、後から調査した結果、<code>brew cleanup</code>以外にも<code>brew search</code>等で変更したCaskが実行されてしまうことがわかった。<br>どうやら、一部のコマンドを実行した際に全てのCaskを評価する設計になっていたため、対象のCaskをインストールしていなかったとしても、変更後のコードが実行されてしまう状態になっていたようだった。</p><p>加えた変更がログを出力するのみだったこと、及びすぐに変更が巻き戻されたことにより大した影響はなかったが、このようなことが起きることを想定していなかったため、非常に焦った。</p><h2 id=まとめ>まとめ</h2><p>今回の記事では、HomebrewのOfficial Tapに存在した脆弱性について解説しました。<br>この脆弱性が悪用されていた場合、発覚するまでの間に<code>brew</code>で特定の操作を行ったユーザー全員のコンピュータが侵害されることに繋がったと考えると、中央集権的なエコシステムに関する監査は必要不可欠だと感じました。<br>PyPIやnpm registry等に対する脆弱性診断も行いたいとは思っているのですが、残念ながら脆弱性の診断行為を許可する旨が明示的に記載されていないため、現在の所行うことができません。</p><p>本記事に関する質問はTwitter(<a href=https://twitter.com/ryotkak target=_blank>@ryotkak</a>)へメッセージを投げてください。</p><h2 id=タイムライン>タイムライン</h2><table><thead><tr><th>日付 (日本時間)</th><th>出来事</th></tr></thead><tbody><tr><td>2021/04/17</td><td>脆弱性の発見</td></tr><tr><td>2021/04/17</td><td>メンテナに対して連絡</td></tr><tr><td>2021/04/18</td><td>メンテナからの返信を受信</td></tr><tr><td>2021/04/18 17時頃</td><td>デモンストレーションを開始</td></tr><tr><td>2021/04/18 17時頃</td><td>レポートを送信</td></tr><tr><td>2021/04/18 18時頃</td><td>プルリクエストをマージさせることに成功</td></tr><tr><td>2021/04/18 19時頃</td><td>プルリクエストが巻き戻される</td></tr><tr><td>2021/04/18 20時頃</td><td>一次対応が完了</td></tr><tr><td>2021/04/19</td><td>二次対応が完了</td></tr><tr><td>2021/04/21</td><td>インシデントの開示</td></tr></tbody></table><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>具体的に言うと、改善前の<a href=https://ja.wikipedia.org/wiki/Dead_by_Daylight target=_blank>Dead by Daylight</a>のマッチ待ち時間ぐらい <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>また、Homebrewでは2018年に<a href=https://brew.sh/2018/08/05/security-incident-disclosure/ target=_blank>GitHub API Tokenの漏洩に関連したインシデント</a>が発生していたため、所属メンバーの意識も高かったものと思われる。 <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>直近3つの記事が全てGitHub Actionsに関連したものであることに関しては非常に申し訳ないと思っている。 (が、GitHub Actionsは攻撃対象領域として非常に優秀なのだ。) <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p><a href=https://github.com/Homebrew/actions/blob/bac0cf0eef64950c5fa7b60134da80f5f52d87ab/.github/workflows/review-cask-pr.yml>https://github.com/Homebrew/actions/blob/bac0cf0eef64950c5fa7b60134da80f5f52d87ab/.github/workflows/review-cask-pr.yml</a> <a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5 role=doc-endnote><p>発見した脆弱性に重要でない条件は省略したが、他にも多数の条件が存在した。
詳しくは <a href=https://github.com/Homebrew/actions/blob/bac0cf0eef64950c5fa7b60134da80f5f52d87ab/.github/workflows/review-cask-pr.yml>https://github.com/Homebrew/actions/blob/bac0cf0eef64950c5fa7b60134da80f5f52d87ab/.github/workflows/review-cask-pr.yml</a> を確認してほしい。 <a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6 role=doc-endnote><p>二行目が文字列リテラルになっていないのは意図的であり、<code>git_diff</code>のバグにより文字列リテラルを閉じた際のダブルクオーテーションもファイルパスとして扱われてしまうためである。 <a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7 role=doc-endnote><p>この時点では、各Caskファイルは<code>brew install</code>を実行した際にしか実行されないと思っていたため、メンテナと連絡が取れている状況を鑑み、すぐに取り消せば実際に変更したコードを実行するユーザーは発生しないと考えていた。 <a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:8 role=doc-endnote><p><a href=https://github.com/Homebrew/homebrew-cask/pull/104191>https://github.com/Homebrew/homebrew-cask/pull/104191</a> <a href=#fnref:8 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article></div><aside class="col-12 col-md-3 float-left sidebar"><div class="sidebar-item sidebar-pages"><h3>ページ</h3><ul><li><a href=/>Home</a></li><li><a href=/archives/>Archives</a></li><li><a href=/about/>About</a></li><li><a href=/search/>Search</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div class="sidebar-item sidebar-links"><h3>リンク</h3><ul><li><a href=https://twitter.com/ryotkak target=_blank><span>Twitter</span></a></li><li><a href=https://github.com/Ry0taK target=_blank><span>GitHub</span></a></li></ul></div><div class="sidebar-item sidebar-tags"><h3>タグ</h3><div><span><a href=/tags/brute-force/>Brute Force</a></span>
<span><a href=/tags/bug-bounty/>Bug Bounty</a></span>
<span><a href=/tags/cdnjs/>cdnjs</a></span>
<span><a href=/tags/fleet/>Fleet</a></span>
<span><a href=/tags/github/>GitHub</a></span>
<span><a href=/tags/github-actions/>GitHub Actions</a></span>
<span><a href=/tags/go/>Go</a></span>
<span><a href=/tags/homebrew/>Homebrew</a></span>
<span><a href=/tags/idor/>IDOR</a></span>
<span><a href=/tags/microsoft/>Microsoft</a></span>
<span><a href=/tags/privilege-escalation/>Privilege Escalation</a></span>
<span><a href=/tags/rce/>RCE</a></span>
<span><a href=/tags/ruby/>Ruby</a></span>
<span><a href=/tags/supply-chain/>Supply Chain</a></span>
<span><a href=/tags/timing-attack/>Timing Attack</a></span>
<span><a href=/tags/twitter/>Twitter</a></span>
<span><a href=/tags/vscode/>VSCode</a></span>
<span><a href=/tags/vulnerability/>Vulnerability</a></span>
<span><a href=/tags/%E8%84%86%E5%BC%B1%E6%80%A7/>脆弱性</a></span></div></div></aside></div><div class=btn><div class=btn-menu id=btn-menu><i class="iconfont icon-grid-sharp"></i></div><div class=btn-toggle-mode><i class="iconfont icon-contrast-sharp"></i></div><div class=btn-scroll-top><i class="iconfont icon-chevron-up-circle-sharp"></i></div></div><aside class=sidebar-mobile style=display:none><div class=sidebar-wrapper><div class="sidebar-item sidebar-pages"><h3>ページ</h3><ul><li><a href=/>Home</a></li><li><a href=/archives/>Archives</a></li><li><a href=/about/>About</a></li><li><a href=/search/>Search</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div class="sidebar-item sidebar-links"><h3>リンク</h3><ul><li><a href=https://twitter.com/ryotkak target=_blank><span>Twitter</span></a></li><li><a href=https://github.com/Ry0taK target=_blank><span>GitHub</span></a></li></ul></div><div class="sidebar-item sidebar-tags"><h3>タグ</h3><div><span><a href=/tags/brute-force/>Brute Force</a></span>
<span><a href=/tags/bug-bounty/>Bug Bounty</a></span>
<span><a href=/tags/cdnjs/>cdnjs</a></span>
<span><a href=/tags/fleet/>Fleet</a></span>
<span><a href=/tags/github/>GitHub</a></span>
<span><a href=/tags/github-actions/>GitHub Actions</a></span>
<span><a href=/tags/go/>Go</a></span>
<span><a href=/tags/homebrew/>Homebrew</a></span>
<span><a href=/tags/idor/>IDOR</a></span>
<span><a href=/tags/microsoft/>Microsoft</a></span>
<span><a href=/tags/privilege-escalation/>Privilege Escalation</a></span>
<span><a href=/tags/rce/>RCE</a></span>
<span><a href=/tags/ruby/>Ruby</a></span>
<span><a href=/tags/supply-chain/>Supply Chain</a></span>
<span><a href=/tags/timing-attack/>Timing Attack</a></span>
<span><a href=/tags/twitter/>Twitter</a></span>
<span><a href=/tags/vscode/>VSCode</a></span>
<span><a href=/tags/vulnerability/>Vulnerability</a></span>
<span><a href=/tags/%E8%84%86%E5%BC%B1%E6%80%A7/>脆弱性</a></span></div></div></div></aside></main><footer><div class="container-lg clearfix"><div class="col-12 footer"><span>&copy; 2021
<a href=https://blog.ryotak.me>RyotaK</a>
| Powered by <a href=https://github.com/dsrkafuu/hugo-theme-fuji/ target=_blank>Fuji-v2</a> & <a href=https://gohugo.io/ target=_blank>Hugo</a></span></div></div></footer><script defer src=https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js></script><script defer src=/assets/js/fuji.min.js></script></body></html>